Copy from [STAM](https://github.com/Alibaba-MIIL/STAM)